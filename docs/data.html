<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.262">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Using stelfi">

<title>The R package stelfi - 7&nbsp; Datasets in stelfi</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./references.html" rel="next">
<link href="./summary.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="site_libs/twitter-widget-0.0.1/widgets.js"></script>


</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">The <code>R</code> package <code>stelfi</code></span>
    </a>
  </div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Datasets in <code>stelfi</code></span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        <div class="sidebar-tools-collapse">
    <a href="https://github.com/cmjt/stelfi" title="" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
    <a href="mailto:c.jonestodd@auckland.ac.nz" title="" class="sidebar-tool px-1"><i class="bi bi-envelope"></i></a>
</div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./univariate-hawkes.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Univariate Hawkes</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./marked-hawkes.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Marked Hawkes</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./multi-hawkes.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Multivariate Hawkes</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lgcp.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Log-Gaussian Cox process</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Key <code>stelfi</code> functions</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Datasets in <code>stelfi</code></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#temporal-point-pattern-data" id="toc-temporal-point-pattern-data" class="nav-link active" data-scroll-target="#temporal-point-pattern-data"><span class="toc-section-number">7.1</span>  Temporal point pattern data</a>
  <ul class="collapse">
  <li><a href="#retweets_niwa" id="toc-retweets_niwa" class="nav-link" data-scroll-target="#retweets_niwa"><code>retweets_niwa</code></a></li>
  <li><a href="#uk_serial" id="toc-uk_serial" class="nav-link" data-scroll-target="#uk_serial"><code>uk_serial</code></a></li>
  </ul></li>
  <li><a href="#spatiotemporal-point-pattern-data" id="toc-spatiotemporal-point-pattern-data" class="nav-link" data-scroll-target="#spatiotemporal-point-pattern-data"><span class="toc-section-number">7.2</span>  Spatiotemporal point pattern data</a>
  <ul class="collapse">
  <li><a href="#sasquatch" id="toc-sasquatch" class="nav-link" data-scroll-target="#sasquatch"><code>sasquatch</code></a></li>
  <li><a href="#nz_earthquakes" id="toc-nz_earthquakes" class="nav-link" data-scroll-target="#nz_earthquakes"><code>nz_earthquakes</code></a></li>
  <li><a href="#nz_murders" id="toc-nz_murders" class="nav-link" data-scroll-target="#nz_murders"><code>nz_murders</code></a></li>
  <li><a href="#iraq_terrorism" id="toc-iraq_terrorism" class="nav-link" data-scroll-target="#iraq_terrorism"><code>iraq_terrorism</code></a></li>
  </ul></li>
  <li><a href="#simulated-data" id="toc-simulated-data" class="nav-link" data-scroll-target="#simulated-data"><span class="toc-section-number">7.3</span>  Simulated data</a>
  <ul class="collapse">
  <li><a href="#xyt" id="toc-xyt" class="nav-link" data-scroll-target="#xyt"><code>xyt</code></a></li>
  <li><a href="#marked" id="toc-marked" class="nav-link" data-scroll-target="#marked"><code>marked</code></a></li>
  <li><a href="#horse_mesh" id="toc-horse_mesh" class="nav-link" data-scroll-target="#horse_mesh"><code>horse_mesh</code></a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="data" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Datasets in <code>stelfi</code></span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>Below are the data packaged within <code>stelfi</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">load_all</span>(<span class="st">"~/Git/stelfi"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>ℹ Loading stelfi</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="at">package =</span> <span class="st">"stelfi"</span>)<span class="sc">$</span>result[, <span class="fu">c</span>(<span class="st">"Item"</span>, <span class="st">"Title"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Item             Title
 [1,] "horse_mesh"     ""   
 [2,] "horse_sf"       ""   
 [3,] "iraq_terrorism" ""   
 [4,] "marked"         ""   
 [5,] "multi_hawkes"   ""   
 [6,] "nz_earthquakes" ""   
 [7,] "nz_murders"     ""   
 [8,] "retweets_niwa"  ""   
 [9,] "sasquatch"      ""   
[10,] "uk_serial"      ""   
[11,] "xyt"            ""   </code></pre>
</div>
</div>
<section id="temporal-point-pattern-data" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="temporal-point-pattern-data"><span class="header-section-number">7.1</span> Temporal point pattern data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="do">## load the tidyverse packages</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="retweets_niwa" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="retweets_niwa"><code>retweets_niwa</code></h3>
<p>In 2019 a <a href="https://niwa.co.nz/">NIWA</a> scientist <a href="https://www.nzherald.co.nz/nz/news/article.cfm?c_id=1&amp;objectid=12201147">found a working USB in the scat of a leopard seal</a>, they then <a href="https://twitter.com/niwa_nz/status/1092610541401587712">tweeted about it</a> in the hopes of finding its owner. In <a href="univariate-hawkes.html">this chapter</a> a Hawkes process is fitted to these data.</p>
<div class="cell">
<div class="cell-output-display">
<blockquote class="twitter-tweet blockquote" data-width="550" data-lang="en" data-dnt="true" data-theme="light"><p lang="en" dir="ltr">NIWA is searching for the owner of a USB stick found in the poo of a leopard seal… <br>Recognise this video? Scientists analysing the scat of leopard seals have come across an unexpected discovery – a USB stick full of photos &amp; still in working order!  <a href="https://t.co/2SZVkm5az4">https://t.co/2SZVkm5az4</a> <a href="https://t.co/JLEC8vuHH0">pic.twitter.com/JLEC8vuHH0</a></p>— NIWA (@niwa_nz) <a href="https://twitter.com/niwa_nz/status/1092610541401587712?ref_src=twsrc%5Etfw">February 5, 2019</a></blockquote>

</div>
</div>
<p>The <code>retweets_niwa</code> dataset contains the retweet timestamps for this tweet.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(retweets_niwa, <span class="at">package =</span> <span class="st">"stelfi"</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(retweets_niwa)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2019-02-07 06:50:08 UTC" "2019-02-07 06:50:08 UTC"
[3] "2019-02-07 06:49:22 UTC" "2019-02-07 06:48:48 UTC"
[5] "2019-02-07 06:47:52 UTC" "2019-02-07 06:47:42 UTC"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">time =</span> retweets_niwa), <span class="fu">aes</span>(<span class="at">x =</span> time)) <span class="sc">+</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Retweet frequency"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="data_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="uk_serial" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="uk_serial"><code>uk_serial</code></h3>
<p><a href="http://www.murderuk.com/">Murder UK</a> documents some of the UKs most infamous multiple murderer cases. The <code>uk_serial</code> dataset contains summary information about the documented cases along with approximate timeframes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"uk_serial"</span>, <span class="at">package =</span> <span class="st">"stelfi"</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(uk_serial)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  number_of_kills       years                           name                aka
1             300 1995 - 1998             Dr. Harold Shipman          Dr. Death
2             160 1949 - 1983          Dr. John Bodkin Adams                   
3              26        1978                 Peter Dinsdale          Bruce Lee
4              21 1865 - 1872                Mary Ann Cotton                   
5              16        1828 William Burke and William Hare     Body Snatchers
6              15 1944 - 1948              John George Haigh Acid Bath Murderer
  year_start year_end date_of_first_kill population_million
1       1995     1998            03/1995              58.02
2       1949     1983            08/1949              50.32
3       1973       NA            06/1973              56.19
4       1865     1872            01/1865              24.36
5       1828       NA            02/1828              15.73
6       1944     1948            09/1944              49.02</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>uk_serial <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time =</span>  <span class="fu">paste</span>(date_of_first_kill, <span class="st">"/01"</span>, <span class="at">sep=</span><span class="st">''</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time =</span> <span class="fu">as.Date</span>(time, <span class="st">"%m/%Y/%d"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> time)) <span class="sc">+</span> </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span> </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Frequency of known first kill"</span>) <span class="sc">+</span> </span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="data_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="spatiotemporal-point-pattern-data" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="spatiotemporal-point-pattern-data"><span class="header-section-number">7.2</span> Spatiotemporal point pattern data</h2>
<p>Using <code>maps</code> to create <code>sf</code> objects of country boundaries:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>us <span class="ot">&lt;-</span> maps<span class="sc">::</span><span class="fu">map</span>(<span class="st">"usa"</span>, <span class="at">fill =</span> <span class="cn">TRUE</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    sf<span class="sc">::</span><span class="fu">st_as_sf</span>() <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    sf<span class="sc">::</span><span class="fu">st_make_valid</span>()</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>nz <span class="ot">&lt;-</span> maps<span class="sc">::</span><span class="fu">map</span>(<span class="st">"nz"</span>, <span class="at">fill =</span> <span class="cn">TRUE</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    sf<span class="sc">::</span><span class="fu">st_as_sf</span>() <span class="sc">%&gt;%</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    sf<span class="sc">::</span><span class="fu">st_make_valid</span>()</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>iraq <span class="ot">&lt;-</span> maps<span class="sc">::</span><span class="fu">map</span>(<span class="st">"world"</span>, <span class="st">"Iraq"</span>, <span class="at">fill =</span> <span class="cn">TRUE</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>     sf<span class="sc">::</span><span class="fu">st_as_sf</span>() <span class="sc">%&gt;%</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    sf<span class="sc">::</span><span class="fu">st_make_valid</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="sasquatch" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="sasquatch"><code>sasquatch</code></h3>
<p>The <a href="https://www.bfro.net/">Bigfoot Field Researchers Organization (BFRO)</a> documents Bigfoot (Sasquatch) sightings; some data have been <a href="https://data.world/timothyrenner/bfro-sightings-data">collated</a> and packaged in <code>stelfi</code> as<code>sasquatch</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"sasquatch"</span>, <span class="at">package =</span> <span class="st">"stelfi"</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>sasquatch</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 972 features and 27 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: -124.5301 ymin: 25.84875 xmax: -70.75587 ymax: 48.9058
Geodetic CRS:  +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0
# A tibble: 972 × 28
   observed         location_details county state season title date       number
 * &lt;chr&gt;            &lt;chr&gt;            &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;date&gt;      &lt;dbl&gt;
 1 "For the past f… This location i… Shann… Sout… Fall   Repo… 2002-12-04   5173
 2 "My family had … East on Route 1… Wayne… New … Fall   Repo… 2003-09-20  26566
 3 "While this inc… Ward County, Ju… Ward … Nort… Spring Repo… 2000-04-21    751
 4 "(Please see Mi… &lt;NA&gt;             Mount… Nort… Winter Repo… 2004-02-22   8165
 5 "I was coming h… forested wetlan… Warre… New … Summer Repo… 2005-12-21  13276
 6 "My summer ecol… We were on the … Taos … New … Spring Repo… 2000-05-17   4904
 7 "On Aug 26 arou… From Garrison t… McLea… Nort… Summer Repo… 2005-08-27  12562
 8 "Foot prints wh… The location wa… McKen… Nort… Winter Repo… 2004-02-26   8130
 9 "The following … Georgia Ave. an… Sarpy… Nebr… Summer Repo… 2005-01-06   7809
10 "We live near O… (Location withh… Dougl… Nebr… Summer Repo… 2005-08-13  12482
# ℹ 962 more rows
# ℹ 20 more variables: classification &lt;chr&gt;, geohash &lt;chr&gt;,
#   temperature_high &lt;dbl&gt;, temperature_mid &lt;dbl&gt;, temperature_low &lt;dbl&gt;,
#   dew_point &lt;dbl&gt;, humidity &lt;dbl&gt;, cloud_cover &lt;dbl&gt;, moon_phase &lt;dbl&gt;,
#   precip_intensity &lt;dbl&gt;, precip_probability &lt;dbl&gt;, precip_type &lt;chr&gt;,
#   pressure &lt;dbl&gt;, summary &lt;chr&gt;, uv_index &lt;dbl&gt;, visibility &lt;dbl&gt;,
#   wind_bearing &lt;dbl&gt;, wind_speed &lt;dbl&gt;, year &lt;dbl&gt;, geometry &lt;POINT [°]&gt;</code></pre>
</div>
</div>
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sasquatch, <span class="fu">aes</span>(<span class="at">x =</span> date)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">150</span>) <span class="sc">+</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Frequency of Sasquatch sightings"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="data_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sasquatch) <span class="sc">+</span>  </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span> </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_sf</span>() <span class="sc">+</span> </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> us, <span class="at">fill =</span> <span class="cn">NA</span>) <span class="sc">+</span> </span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Coordinate system already present. Adding new coordinate system, which will
replace the existing one.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="data_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="nz_earthquakes" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="nz_earthquakes"><code>nz_earthquakes</code></h3>
<p><a href="http://quakesearch.geonet.org.nz/">GeoNet Quake Search</a> catalogues New Zealand earthquake occurrence; some of these data have been and packaged in <code>stelfi</code> as <code>nz_earthquakes</code>. In <a href="univariate-hawkes.html">this chapter</a> a Hawkes process is fitted to these data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"nz_earthquakes"</span>, <span class="at">package =</span> <span class="st">"stelfi"</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>nz_earthquakes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 3824 features and 3 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 169.83 ymin: -44.86892 xmax: 175.6328 ymax: -41.8628
Geodetic CRS:  +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0
First 10 features:
            origintime magnitude     depth                   geometry
1  2014-12-24 07:46:00  3.208996 13.671875 POINT (172.7133 -43.57944)
2  2014-12-24 06:43:00  4.109075  5.820312 POINT (172.7204 -43.55752)
3  2014-12-14 08:53:00  3.240377  5.058594 POINT (172.3641 -43.62563)
4  2014-12-12 13:37:00  4.459034  9.394531  POINT (172.368 -43.63492)
5  2014-11-20 08:24:00  3.116447 10.039062 POINT (172.7836 -43.42493)
6  2014-11-18 14:19:00  3.158710 11.269531  POINT (172.7936 -43.4897)
7  2014-11-02 06:45:00  3.708697 14.960938 POINT (170.2523 -44.48656)
8  2014-10-11 22:32:00  3.456145 39.804688 POINT (173.1383 -42.67562)
9  2014-10-01 20:58:00  3.106894 11.386719 POINT (172.6879 -43.49002)
10 2014-09-30 15:29:00  3.911931  9.335938 POINT (172.1428 -43.25048)</code></pre>
</div>
</div>
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(nz_earthquakes, <span class="fu">aes</span>(<span class="at">x =</span> origintime)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Frequency of earthquakes"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="data_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(nz_earthquakes) <span class="sc">+</span>  </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_sf</span>() <span class="sc">+</span> </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> nz, <span class="at">fill =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Coordinate system already present. Adding new coordinate system, which will
replace the existing one.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="data_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="nz_murders" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="nz_murders"><code>nz_murders</code></h3>
<p><a href="https://interactives.stuff.co.nz/2019/the-homicide-report/">The Homicide Report</a> documents homicides in New Zealand. The <code>nz_murders</code> dataset contains summary information about the documented cases. In <a href="univariate-hawkes.html">this chapter</a> a spatiotemporal self-exciting model is fitted to these data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"nz_murders"</span>, <span class="at">package =</span> <span class="st">"stelfi"</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>nz_murders</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 967 features and 11 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 167.9161 ymin: -46.96127 xmax: 178.3955 ymax: -34.54022
Geodetic CRS:  +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0
First 10 features:
      sex age   date year                      cause              killer
1    Male  41  Jan 5 2004                   stabbing              friend
2    Male  46  Jan 8 2004            pick axe wounds              friend
3    Male   0 Jan 15 2004 asphyxiation (suffocation)              mother
4  Female  46  Feb 1 2004         blunt force trauma             partner
5    Male  10  Feb 2 2004                   stabbing              father
6  Female   2  Feb 2 2004                   stabbing              father
7    Male  36  Feb 4 2004                   stabbing partners ex-partner
8    Male  20  Feb 8 2004                  car crash              friend
9    Male  29  Feb 8 2004         blunt force trauma           strangers
10 Female  32 Feb 15 2004         blunt force trauma             husband
                      name  full_date    month          cause_cat     region
1           Donald Linwood 2004-01-05  January     Violent weapon Canterbury
2              James Weeks 2004-01-08  January     Violent weapon Canterbury
3  Gabriel Harrison-Taylor 2004-01-15  January           Asphyxia   Auckland
4    Odette Lloyd-Rangiuia 2004-02-01 February Blunt force trauma Canterbury
5          Te Hau OCarroll 2004-02-02 February     Violent weapon Wellington
6         Ngamata OCarroll 2004-02-02 February     Violent weapon Wellington
7          Darryn McRobert 2004-02-04 February     Violent weapon Canterbury
8           Peretiso Sauni 2004-02-08 February          Car crash   Auckland
9           Shannon McComb 2004-02-08 February Blunt force trauma Canterbury
10        Asolelei Sameulu 2004-02-15 February Blunt force trauma   Auckland
                     geometry
1  POINT (171.6442 -43.63394)
2  POINT (172.1305 -43.28563)
3  POINT (174.8498 -36.92575)
4  POINT (172.6327 -43.55006)
5  POINT (175.1195 -40.73297)
6  POINT (175.1193 -40.73273)
7  POINT (172.5172 -43.53866)
8  POINT (174.7335 -36.89708)
9  POINT (172.6429 -43.54363)
10 POINT (174.6274 -36.90353)</code></pre>
</div>
</div>
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(nz_murders, <span class="fu">aes</span>(<span class="at">x =</span> full_date)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Frequency of murders"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 8 rows containing non-finite outside the scale range
(`stat_bin()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="data_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">

</div>
</section>
<section id="iraq_terrorism" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="iraq_terrorism"><code>iraq_terrorism</code></h3>
<p><a href="http://www.start.umd.edu/gtd/">The Global Terrorism Database (GTD)</a> documents information on terrorism events worldwide; some of these data have been and packaged in <code>stelfi</code> as <code>iraq_terrorism</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"iraq_terrorism"</span>, <span class="at">package =</span> <span class="st">"stelfi"</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>iraq_terrorism</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 4208 features and 16 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 38.92288 ymin: 30.51005 xmax: 47.7781 ymax: 36.92948
Geodetic CRS:  +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0
First 10 features:
      iyear imonth iday country success nkill specificity
18055  2013      4   18    Iraq    TRUE    28           1
18109  2013      4   20    Iraq    TRUE     0           1
18110  2013      4   20    Iraq    TRUE     0           1
18111  2013      4   20    Iraq    TRUE     0           1
18864  2013      5   16    Iraq    TRUE     3           1
18865  2013      5   16    Iraq    TRUE     3           1
18866  2013      5   16    Iraq    TRUE     2           1
18867  2013      5   16    Iraq    TRUE     3           1
19161  2013      5   27    Iraq    TRUE     6           1
19166  2013      5   27    Iraq    TRUE     1           1
                                            gname   x_coord   y_coord   z_coord
18055 Islamic State of Iraq and the Levant (ISIL) 0.5974251 0.5844656 0.5490748
18109 Islamic State of Iraq and the Levant (ISIL) 0.5997164 0.5864987 0.5443892
18110 Islamic State of Iraq and the Levant (ISIL) 0.5992751 0.5859289 0.5454876
18111 Islamic State of Iraq and the Levant (ISIL) 0.5959873 0.5733453 0.5622049
18864 Islamic State of Iraq and the Levant (ISIL) 0.5974251 0.5844656 0.5490748
18865 Islamic State of Iraq and the Levant (ISIL) 0.5974251 0.5844656 0.5490748
18866 Islamic State of Iraq and the Levant (ISIL) 0.5974251 0.5844656 0.5490748
18867 Islamic State of Iraq and the Levant (ISIL) 0.5876310 0.5507342 0.5927745
19161 Islamic State of Iraq and the Levant (ISIL) 0.5974251 0.5844656 0.5490748
19166 Islamic State of Iraq and the Levant (ISIL) 0.5974251 0.5844656 0.5490748
      popdensity luminosity         tt    utm_x      utm_y
18055  0.4065874  1.0924644 -0.3210921 333098.1 4007920.00
18109 -0.3479151  0.2298066 -0.2726546 407264.8 5332968.87
18110 -0.3479432  0.9717434 -0.3210921 401682.9 5252649.56
18111 -0.3783331  1.0521158 -0.3210921 405272.2 5344797.97
18864  0.4065874  1.0924644 -0.3210921 595450.3 4078540.46
18865  0.4065874  1.0924644 -0.3210921 595450.3 4078540.46
18866  0.4065874  1.0924644 -0.3210921 723492.7   45579.28
18867 -0.3665068  1.0924644 -0.3210921 815931.5  435892.29
19161  0.4065874  1.0924644 -0.3210921 252226.3 3703963.04
19166  0.4065874  1.0924644 -0.3210921 756886.0 4023175.15
                       geometry
18055 POINT (44.37177 33.30357)
18109  POINT (44.3616 32.98293)
18110 POINT (44.35484 33.05799)
18111 POINT (43.89071 34.20842)
18864 POINT (44.37177 33.30357)
18865 POINT (44.37177 33.30357)
18866 POINT (44.37177 33.30357)
18867 POINT (43.14357 36.35415)
19161 POINT (44.37177 33.30357)
19166 POINT (44.37177 33.30357)</code></pre>
</div>
</div>
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>iraq_terrorism <span class="sc">%&gt;%</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">paste</span>(iday, imonth, iyear, <span class="at">sep =</span> <span class="st">"/"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">as.Date</span>(date, <span class="st">"%d/%m/%Y"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(., <span class="fu">aes</span>(<span class="at">x =</span> date)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">150</span>) <span class="sc">+</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Frequency of attacks"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="data_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iraq_terrorism) <span class="sc">+</span>  </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span> </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_sf</span>() <span class="sc">+</span> </span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> iraq, <span class="at">fill =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Coordinate system already present. Adding new coordinate system, which will
replace the existing one.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="data_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="simulated-data" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="simulated-data"><span class="header-section-number">7.3</span> Simulated data</h2>
<section id="xyt" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="xyt"><code>xyt</code></h3>
<p>In <a href="lgcp.html">this chapter</a> a log-Gaussian Cox process is fitted to these data and in <a href="#stelfi">this chapter</a> a spatiotemporal selfexciting model is fitted.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"xyt"</span>, <span class="at">package =</span> <span class="st">"stelfi"</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>xyt_sf <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_as_sf</span>(xyt)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>xyt_sf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 654 features and 1 field
Geometry type: GEOMETRY
Dimension:     XY
Bounding box:  xmin: 0 ymin: -2.974928 xmax: 12.56637 ymax: 2.974928
CRS:           NA
First 10 features:
    label                           geom
1  window POLYGON ((10.77117 -2.78183...
2   point       POINT (6.8074 -2.034423)
3   point     POINT (7.558362 -2.193865)
4   point     POINT (8.085083 -2.080938)
5   point     POINT (8.121308 -2.522357)
6   point     POINT (8.362448 -2.303117)
7   point     POINT (9.000749 -2.955328)
8   point     POINT (9.147803 -2.243146)
9   point     POINT (9.261744 -2.408326)
10  point      POINT (8.532312 -2.48986)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(xyt_sf) <span class="sc">+</span> <span class="fu">geom_sf</span>(<span class="at">fill =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="data_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="marked" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="marked"><code>marked</code></h3>
<p>In <a href="#fit-marked">this chapter</a> a marked log-Gaussian Cox process is fitted to these data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(marked, <span class="at">package =</span> <span class="st">"stelfi"</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>marked_sf <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_as_sf</span>(<span class="at">x =</span> marked,</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"x"</span>, <span class="st">"y"</span>))</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>marked_sf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 159 features and 3 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 0.006606752 ymin: 0.006502493 xmax: 2.985087 ymax: 2.938558
CRS:           NA
First 10 features:
          m1 m2        m3                     geometry
1  10.008609  0  9.616468 POINT (0.08935799 0.5756269)
2   8.730592  0  6.918024     POINT (2.177973 2.90455)
3  11.330677  0 16.798212    POINT (2.250791 1.024792)
4  11.338656  0  8.073566    POINT (2.033398 1.038773)
5   9.395725  0  9.977866   POINT (2.777002 0.4685442)
6  10.331965  0 10.615245   POINT (0.5988652 2.422233)
7  10.069787  0 11.268171   POINT (1.541071 0.9307671)
8   9.717775  0 13.306125    POINT (2.615062 1.064561)
9  10.071326  0 18.300715   POINT (0.3882139 2.146845)
10 10.147740  0 16.751740     POINT (1.501552 1.64466)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>domain <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="dv">3</span> <span class="sc">*</span> <span class="fu">cbind</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_polygon</span>() <span class="sc">%&gt;%</span> sf<span class="sc">::</span><span class="fu">st_sfc</span>() <span class="sc">%&gt;%</span> sf<span class="sc">::</span><span class="fu">st_sf</span>(<span class="at">geometry =</span> .)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(marked_sf, <span class="fu">aes</span>(<span class="at">col =</span> m1)) <span class="sc">+</span> </span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Mark"</span>) <span class="sc">+</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_continuous</span>(<span class="at">type =</span> <span class="st">"viridis"</span>) <span class="sc">+</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> domain, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="data_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="horse_mesh" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="horse_mesh"><code>horse_mesh</code></h3>
<p>In <a href="#meshmetrics">this chapter</a> we illustrate different geometric metrics of this triangulation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"horse_mesh"</span>, <span class="at">package =</span> <span class="st">"stelfi"</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>horse_mesh_sf <span class="ot">&lt;-</span> stelfi<span class="sc">::</span><span class="fu">mesh_2_sf</span>(horse_mesh)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>horse_mesh_sf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 396 features and 4 fields
Geometry type: POLYGON
Dimension:     XY
Bounding box:  xmin: -17.96875 ymin: -11.78261 xmax: 17.26563 ymax: 11.65217
CRS:           NA
First 10 features:
    V1  V2  V3 ID                       geometry
1  172  30 186  1 POLYGON ((8.441837 -2.16176...
2   28 188 162  2 POLYGON ((10.43359 0.913043...
3  168 186  42  3 POLYGON ((5.818232 -3.05894...
4  117  57  63  4 POLYGON ((-3.660156 -8.0326...
5  270 253 121  5 POLYGON ((-8.43636 2.023352...
6   92 144 169  6 POLYGON ((-8.042969 4.47826...
7  175 137 240  7 POLYGON ((5.689521 -1.13385...
8  182 148 111  8 POLYGON ((10.50244 7.199319...
9  253 169 121  9 POLYGON ((-7.850425 2.87106...
10  14  15 116 10 POLYGON ((13.3125 11.56522,...</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(horse_mesh_sf) <span class="sc">+</span> <span class="fu">geom_sf</span>(<span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">col =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="data_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./summary.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Key <code>stelfi</code> functions</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./references.html" class="pagination-link">
        <span class="nav-page-text">References</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>